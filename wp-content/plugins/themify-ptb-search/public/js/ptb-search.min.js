!function($){"use strict";var o=!1,u=function(c,l){var p=c.length-1;$.ajax({url:ptb_search.ajaxurl,type:"POST",dataType:"json",data:{action:"ptb_search_set_values",data:c[l]},success:function(e){var t,a=$($("form.ptb-search-form")[l]);for(t in e)if(e[t].min){var n=Math.floor(e[t].min),r=Math.floor(e[t].max),i=$("#"+t+"_min"),s=$("#"+t+"_max");i.val()||i.val(n),s.val()||s.val(r),i.attr("min",n),s.prop("max",r)}else for(var o in e[t])$("#"+t+"_"+e[t][o]).length?$("#"+t+"_"+e[t][o]).prop("disabled",!0).closest("label").addClass("ptb-search-disabled"):$("#"+t).is("select")&&$("#"+t).find('option[value="'+e[t][o]+'"]').prop("disabled",!0).end().trigger("chosen:updated");!function(o){if($.fn.slider)o.find(".ptb-search-slider").each(function(){var e=$(this).closest(".ptb_search_wrap_number"),n=e.find(".ptb_search_number_max"),r=e.find(".ptb_search_number_min"),t=parseInt(r.prop("min")),a=parseInt(n.prop("max")),i=parseInt(r.val()),s=parseInt(n.val());if(!isNaN(t)&&!isNaN(a))$(this).slider({range:true,min:t,step:1,max:a,values:[i,s],slide:function(e,t){r.val(t.values[0]);n.val(t.values[1]);var a=$(this).find(".ptb-search-slider-tooltip-inner");a.first().html(t.values[0]);a.last().html(t.values[1])},stop:function(e,t){var a=o.closest(".ptb-search-form");if(!a.hasClass("ptb-search-no-ajax")&&!a.find('input[type="submit"]').length)a.trigger("submit")},create:function(e,t){var a='<span class="ptb-search-slider-tooltip"><span class="ptb-search-slider-tooltip-inner">'+i+'</span><span class="ptb-search-slider-tooltip-arrow"></span></span>',n=$(this).children(".ui-slider-handle");n.first().html(a);n.last().html(a.replace(i,s))}})})}(a),l<p&&u(c,++l)}})},e=function(){$(".ptb-search-autocomplete").each(function(){var a=$(this),s=a.data("post_type"),o=[];o[s]=[],a.autocomplete({minLength:2,source:function(e,r){var i=$.trim(e.term);i.length<2||((i=i.toLowerCase())in o[s]?r(o[s][i]):(e.action="ptb_search_autocomplete",e.key=a.data("key"),$.getJSON(ptb_search.ajaxurl,e,function(e,t,a){for(const n in e)e[n].label=(e=>{var t=document.createElement("textarea");return t.innerHTML=e,t.innerText})(e[n].label);o[s][i]=e,r(e)})))},select:function(e,t){return a.val(t.item.value),a.next("input").val(t.item.id),!1}}).focus(function(){$(this).autocomplete("search")}).autocomplete("widget").addClass("ptb-search-autocomplete-dropdown")})};function c(e,t=document){let a;const n=[".ptb-search-container .ptb_loops_wrapper","body.archive .ptb_loops_wrapper.ptb_main_query",'.themify_builder_content .module[data-ptb-search-posttype="'+e+'"] > :first-child','.ptb_loops_wrapper[data-type="'+e+'"]:not(.ptb_main_query)'];for(let e=0;e<n.length;e++)if(a=t.querySelector(n[e])){a=a.parentElement;break}return a}var a=function(){$("body").on("submit",".ptb-search-form:not(.ptb-search-no-ajax)",function(e){var r=$(this),i=r.find(".ptb-search-post-type").val();let s=c(i);if(s){e.preventDefault();let a=r.find('input[name="f"]').val(),n=new URL(r[0].action);const t=r.find(":input").filter(function(e,t){return""!=t.value}).serialize();n.search=new URLSearchParams(t),r.find('input[name="p"]').val(""),$.ajax({url:n.href,data:t,type:"GET",beforeSend:function(){r.addClass("ptb-search-submit"),s.classList.add("ptb-search-wait")},complete:function(){r.removeClass("ptb-search-submit"),s.classList.remove("ptb-search-wait")},success:function(e){if(e){e=function(e){return(new DOMParser).parseFromString(e,"text/html")}(e);const t=c(i,e);t&&(s.innerHTML=t.innerHTML,PTB.init(s),r.hasClass("ptb-search-no-scroll")||function(a){if(a.length>0){let e=a.offset().top-10,t=$("#wpadminbar");if(t.length)e-=t.outerHeight(true);$("html,body").animate({scrollTop:e},1e3)}}($(s)),o=a,history.pushState({},null,n.href),$(window).on("popstate",function(e){location.reload()}),void 0!==window.wp&&void 0!==window.wp.mediaelement&&window.wp.mediaelement.initialize(),$(document).trigger("ptb_loaded",!1),document.body.dispatchEvent(new CustomEvent("jetpack-lazy-images-load")),"undefined"!=typeof Themify)&&Themify.lazyScroll(Themify.convert(s.parentElement.querySelectorAll("[data-lazy]")).reverse(),!0)}}})}else r.attr("action",r.attr("data-archive"))}).on("reset",".ptb-search-form",function(){const e=this.closest("form"),t=e.querySelectorAll("input,select");for(let e=t.length-1;0<=e;e--)if("INPUT"===t[e].tagName)switch(t[e].type){case"text":case"number":t[e].value="";break;case"radio":case"checkbox":t[e].checked=!1}else t[e].selectedIndex=0,$(t[e]).val(null).trigger("change");return!1})};var n=function(){$("body").on("click",".ptb-search-container .ptb_pagenav a",function(e){var t=$(".ptb-search-"+o);0<t.length&&(e.preventDefault(),t.find('input[name="ptb_page"]').val(function(e){var t=parseInt(e.text());return t||(t=parseInt(e.closest(".ptb_pagenav").find(".current").text()),e.hasClass("next")?++t:--t),t}($(this))),t.submit())})},r=function(){var e,t;$.timepicker&&(e=$(".ptb_search_field_date input"),t={showOn:"focus",showButtonPanel:!0,showHour:1,showMinute:1,timeOnly:!1,showTimepicker:!1,buttonText:!1,dateFormat:"yy-mm-dd",timeFormat:"hh:mm tt",stepMinute:5,separator:"@",minInterval:0,currentText:ptb_search.i18n.currentText,closeText:ptb_search.i18n.closeText,timeText:ptb_search.i18n.timeText,beforeShow:function(){$("#ui-datepicker-div").addClass("ptb_extra_datepicker ptb_search_datepicker")},onClose:function(e,t){}},e.each(function(){var e=$(this).data("id");e&&(e=$("#"+e+"_end"),$(this).data("time")&&(t.showTimepicker=1),$.timepicker.datetimeRange($(this),e,t))}))};window.addEventListener("load",function(){$("body").on("change",".ptb-search-form select, .ptb-search-form input, .ptb-search-form textarea",function(){var e=$(this).closest(".ptb-search-form");e.hasClass("ptb-search-no-ajax")||e.find('input[type="submit"]').length||e.trigger("submit")}),function(){$.fn.select2&&$("form.ptb-search-form").find("select").select2({width:"100%"})}(),e();var t=[];$("form.ptb-search-form").each(function(e){t[e]=$(this).find(".ptb_search_keys").val()}),void 0!==window.ptb_searched_slug&&(o=window.ptb_searched_slug),"ontouchstart"in window||0<navigator.MaxTouchPoints||0<navigator.msMaxTouchPoints?PTB.LoadAsync(ptb_search.url+"js/jquery.ui.touch-punch.min.js",function(){r(),u(t,0)},null,ptb_search.ver):(u(t,0),r()),a(),n()},{once:!0,passive:!0})}(jQuery);