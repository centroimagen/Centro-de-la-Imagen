($=>{"use strict";function j(t){for(var e=window.location.search.substring(1).split("&"),i=0;i<e.length;i++){var n=e[i].split("=");if(n[0]===t)return n[1]}return!1}function t(t){$(function(){t.init&&t.init()})}t(function(){return{init(){!function(){$("#ptb-cpt-filter").length}()}}}()),t(function(){var t,n,a,o,r,p,s,l,c,d,e,_,i,u=".ptb_cmb_item_collapse",m=".ptb_cmb_item_remove",b=".ptb_cmb_item_body",f=function(e,i,t){var n,a,o,r="#"+i.type+"_\\{\\{id\\}\\}";return 0<$(r).length&&(n=t?new RegExp(i.type+"_{{id}}","gi"):new RegExp("{{id}}","gi"),r=$(r).clone()[0].outerHTML.replace(n,t?e:i.id),r=(n=$(r).appendTo(_)).find("input[id^="+e+"_name_]"),a=n.find("input[id^="+e+"_description_]"),o=n.find("input[id^="+e+"_slug]"),r.each(function(){var t=$(this).attr("id").replace(e+"_name_","");$(this).val(i.name[t])}),a.each(function(){var t=$(this).attr("id").replace(e+"_description_","");$(this).val(i.description[t])}),void 0===l||""===l||t?o.val(e):o.val(l+"_"+e),t&&o.prop("readonly",!0),void 0!==i.admin_column&&!0===i.admin_column&&(n.find("input[id^="+e+"_admin_column]")[0].checked=!0),r=n.find(b),x(n.find(m)),y(n.find(u)),$.event.trigger({type:"ptb_metabox_create",id:e,options:i,container:r}),$.event.trigger({type:"ptb_metabox_create_"+i.type,id:e,options:i,container:r}),n.data(e,i),n)},h=function(){var t=function(){return e.val()}();if(t){try{d=JSON.parse(t),Array.isArray(d)&&(d={})}catch(t){return}$.each(d,function(t,e){t=f(t,e,1);t&&t.show()}),!function(){_.sortable({placeholder:"ui-state-highlight",handle:".ptb_cmb_item_title_wrapper"})}()}},v=function(t){return t.replace(/[^A-Za-z0-9_]+/g,"_").toLowerCase()},g=function(){d={},_.children().each(function(t,e){var i=e.id,n=i,a=$("input[id^="+i+"_slug]"),a=(a&&!a.prop("readonly")&&(i=e.id=v(a.val()),$(e).find("input,select,.ptb_cmb_options_wrapper").each(function(){var t=$(this).prop("name"),e=$(this).prop("id");t&&$(this).prop("name",t.replace(n,i)),e&&$(this).prop("id",e.replace(n,i))}),$("#"+n).prop("id",i)),d[i]=$.data(e)[n],$("input[id^="+i+"_name_]")),e=$("input[id^="+i+"_description]");d[i].name={},a.each(function(){var t=$(this).attr("id").replace(i+"_name_","");d[i].name[t]=$(this).val()}),d[i].description={},e.each(function(){var t=$(this).attr("id").replace(i+"_description_","");d[i].description[t]=$(this).val()}),delete d[i].admin_column,$("input[id^="+i+"_admin_column]").is(":checked")&&(d[i].admin_column=!0),$.event.trigger({type:"ptb_metabox_save_"+d[i].type,id:i,options:d[i]})}),e.val(JSON.stringify(d)),_.find("[name]").removeAttr("name"),$(".ptb_cmb_item_wrapper").find("[name]").removeAttr("name")},y=function(t){$(t).on("click",function(t){$(this).closest("li").toggleClass("collapse"),$(this).parent().next().toggle("blind",500)})},x=function(t){$(t).on("click",function(t){var e=$(this).parents(".ptb_cmb_item_wrapper"),i=e.attr("id");e.hide("blind",500),e.data(i).deleted=!0})},w=function(){i.children().each(function(t,e){var n=$(this).data("type");$(e).on("click",function(t){t.preventDefault(),$.event.trigger({type:"ptb_add_metabox"}),$.event.trigger({type:"ptb_add_metabox_"+n})}),$(document).on("ptb_add_metabox_"+n,function(t){var t=t.result||{},e=function(e){var t=$.map(d,function(t){if(t.type===e)return t.id});return((0===(t=t.filter(function(t){return 0<t})).length?0:Math.max.apply(null,t))||0)+1}(n),i=n+"_"+e;t.type=n,t.id=e,t.deleted=!1,t.name="",t.description="",d[i]=t,f(i,t,!1).hide().show("blind",500),function(){_.sortable("refresh")}()})});const t=document.getElementById("ptb_cpt_menu_icon");if(t){const e=t.nextElementSibling.querySelector("span");t.addEventListener("change",function(){e.className="dashicons-before "+this.value})}},k=function(t,e){e=void 0===e||e;var i=!0;return $.ajax({type:"POST",url:ajaxurl,data:{action:"ptb_ajax_post_type_name_validate",nonce:$("#ptb-ajax-notification-nonce").text().trim(),slug:t},async:e,success:function(t){i=!!t.trim(),T(t,i)}}),i},T=function(t,e){e?(0===c.find("p:contains("+t+")").length&&c.append("<p>"+t+"</p>"),c.fadeIn()):0!==c.find("p").length&&!t||t&&(c.find("p:contains("+t+")").remove(),0!==c.find("p").length)||c.fadeOut("fast")};return{init:function(){(function(){t=$("#ptb_cpt_id"),n=$("#ptb_cpt_singular_label_"+ptb_js_admin.lng),a=$("#ptb_cpt_slug"),o=".ptb_cmb_items_wrapper .ptb_cmb_slug",p='.ptb_cmb_items_wrapper .ptb_active_lng.ptb_meta_name input[type="text"]',r=$("#ptb_cpt_rewrite_slug"),c=$("#ptb_ajax_message"),s=t.val(),l=a.val(),e=$("#ptb_post_type_cmb_data"),_=$(".ptb_cmb_items_wrapper"),i=$(".ptb_cmb_buttons_wrapper")})(),w(),h(),function(){var t,e=$("form"),e=("add"===j("action")&&n.on("keyup change",function(){l=function(t){return t.replace(/[^A-Za-z0-9_]+/g,"-").toLowerCase().substr(0,20)}($(this).val()),a.val()!==l&&(a.val(l).trigger("change"),r.val(l))}),a.on("change",function(){l=$(this).val(),s===l&&""!==l||(clearTimeout(t),t=setTimeout(function(){k(l)},250))}),$("body").on("focusout",o,function(t){var e,i,n,a;$(this).prop("readonly")?$(this).off("focusout"):(e=v($(this).val()),i=" already exists",$(this).val(e),$(".ptb_meta_slug_error").removeClass("ptb_meta_slug_error"),T($(this).data("prev_value")+i,!1),e?(n=!1,a=$(this).prop("id"),$(o).each(function(){$(this).val()===e&&a!==$(this).prop("id")&&($(this).addClass("ptb_meta_slug_error"),n=1)}),n?(T(e+i,!0),$(this).addClass("ptb_meta_slug_error").data("prev_value",e)):$(this).data("ptb_focus",1)):$(this).val($(this).closest(".ptb_cmb_item_wrapper").prop("id")).trigger("focusout"))}).on("focusout",p,function(){var t=$(this).closest(".ptb_cmb_item_wrapper").prop("id");$("#"+t+"_slug").prop("readonly")||$("#"+t+"_slug").data("ptb_focus")?$(this).off("focusout"):(void 0!==l&&""!==l?$("#"+t+"_slug").val(l+"_"+v($(this).val())):$("#"+t+"_slug").val(v($(this).val()))).trigger("focusout")}),e.on("submit",function(t){var e,i,n;!$("input[id^=ptb_cpt_singular_label_"+ptb_js_admin.lng+"]").length||(e=!0,c.find("p").remove(),""!==l&&s===l||(e=!k(l,!1)),i=$("input[id^=ptb_cpt_singular_label_"+ptb_js_admin.lng+"],input[id^=ptb_cpt_plural_label_"+ptb_js_admin.lng+"]"),n=[],i.each(function(){var t;$(this).val().trim()||(e=!1,t=$(this).closest("tr").find("label").text(),n[t])||(T(ptb_js_admin.empty_message.replace("%s",t),!0),n[t]=1)}),$(o).trigger("focusout"),e=!(0<$(".ptb_meta_slug_error").length)&&e)?g():($("html, body").animate({scrollTop:0},"slow"),t.preventDefault())}),e.find(".ptb-collapse + table").each(function(){$(this).hide()}),e.find(".ptb-collapse")),i=e.prev("h2");(i=0===i.length?e.prev("h3"):i).addClass("ptb-collapse-title").on("click",function(){$(this).toggleClass("collapsed").nextAll("table").first().toggle("blind",500)})}()}}}()),t(function(){return{init:function(){!function(){$("#ptb-ctx-filter").length}()}}}()),t(function(){var t,i,a,o,r,p=function(t,e){e=void 0===e||e;var i=!0;return $.ajax({type:"POST",url:ajaxurl,data:{action:"ptb_ajax_taxonomy_name_validate",nonce:$("#ptb-ajax-notification-nonce").text().trim(),slug:t},async:e,success(t){i=!!t.trim(),s(t,i)}}),i},s=function(t,e){e?(r.append("<p>"+t+"</p>"),r.fadeIn()):0===r.find("p").length&&r.fadeOut("fast")};return{init(){!function(){return t=$("#ptb_ctx_id"),i=$("#ptb_ctx_slug"),0!==t.length&&(r=$("#ptb_ajax_message"),a=t.val(),o=i.val(),!0)}()||!function(){var t,e=$("form");"add"===j("action")&&$("#ptb_ctx_singular_label_"+ptb_js_admin.lng).on("keyup keypress blur change",function(){o=$(this).val().replace(/[^A-Za-z0-9_]+/g,"_").toLowerCase(),i.val()!==o&&i.val(o).trigger("change")}),i.on("change",function(){o=$(this).val(),a===o&&""!==o||(clearTimeout(t),t=setTimeout(function(){p(o)},250))}),e.on("submit",function(t){var e=!0,i=(r.find("p").remove(),""!==o&&a===o||(e=!p(o,!1)),$("input[id^=ptb_ctx_singular_label_],input[id^=ptb_ctx_plural_label_]")),n=[];i.each(function(){var t;$(this).val().trim()||(e=!1,t=$(this).closest("tr").find("label").text(),n[t])||(s(ptb_js_admin.empty_message.replace("%s",t),!0),n[t]=1)}),e||($("html, body").animate({scrollTop:0},"slow"),t.preventDefault())})}()}}}()),t(function(){var n,e,r,p,s,l,c,d,t,a=function(t,e){var i=p.clone().appendTo(r),n=s.clone().prependTo(i),a=l.clone().appendTo(n),n=c.clone().appendTo(n),o=d.clone().appendTo(i);return $.event.trigger({type:"ptb_template_item_create",id:t,options:e,container:o}),$.event.trigger({type:"ptb_template_item_create_"+e.type,id:t,options:e,title:a,container:o}),i.data(t,e).attr("id",t),_(n),i},_=function(t){$(t).on("click",function(t){var e=$(this).parents(".ptb_template_item_wrapper"),i=e.attr("id");e.hide(500).data(i).deleted=!0})},i=function(){var t=function(){return e.val()}();if(t){try{n=JSON.parse(t),Array.isArray(n)&&(n={})}catch(t){return}$.each(n,a),!function(){r.sortable({placeholder:"ui-state-highlight",handle:".ptb_back_module_top"}),r.disableSelection()}(),_()}},o=function(){t.children().each(function(t,e){var i=$(this).data("type");$(e).on("click",function(t){t.preventDefault();var t=function(){var t=$.map(n,function(t){return t.id});return((0===(t=t.filter(function(t){return 0<t})).length?0:Math.max.apply(null,t))||0)+1}(),e=i+"_"+t;n[e]={id:t,type:i,deleted:!1,name:$(this).text(),meta_key:$(this).data("meta-key")},a(e,n[e]).hide().show(500),function(){r.sortable("refresh")}()})})},u=function(t){var n=!0;$("a.ptb_lightbox",t).on("click",function(e){var i;e.preventDefault(),!0===n&&(PTB_Common.show_loader(),i=$(this),$.ajax({url:ajaxurl,beforeSend:function(){n=!1},data:{action:"ptb_ajax_themes","ptb-ptt":j("ptb-ptt"),template:i.data("template-type")},success:function(t){PTB_Common.hide_loader(),t&&(openLightBox(e,i.attr("title"),t,!1,!1),n=!0)}}))})},m=function(t){$("a.ptb_ptt_remove",t).on("click",function(t){t.preventDefault(),window.confirm(ptb_js_admin.confirm_remove_template)&&$.ajax({url:ajaxurl,type:"POST",data:{action:"ptb_remove_custom_template","ptb-ptt":j("ptb-ptt"),ptb_type:t.target.dataset.templateType},success(){t.target.closest("div").remove()}})})};return{init(){!function(){return 0!==$("#ptb_ptt_id").length&&(e=$("#ptb_ptt_archive").length?$("#ptb_ptt_archive"):$("#ptb_ptt_single"),r=$("ul.ptb_template_items_wrapper"),p=$('<li class="ptb_template_item_wrapper"></li>'),s=$('<div class="ptb_template_item_title_wrapper"></div>'),l=$('<h4 class="ptb_template_item_title"></h4>'),c=$('<button type="button" class="ptb_template_item_remove" aria-label="Remove"><span aria-hidden="true">&times;</span></button>'),d=$('<div class="ptb_template_item_body"></div>'),t=$(".ptb_template_buttons_wrapper"),!0)}()||(u(),o(),i(),function(){let a=document.getElementById("ptb_new_custom_template");a&&a.addEventListener("click",t=>{t.preventDefault();let n=window.prompt(ptb_js_admin.new_template);if(null!==n&&""!==n){let t=document.createElement("div"),e=document.createElement("a"),i=document.createElement("a");e.setAttribute("href","#"),e.setAttribute("data-template-type","custom_"+n),e.className="ptb_ptt_edit_button ptb_lightbox",e.textContent=ptb_js_admin.edit_template.replace("%s",n),t.appendChild(e),u(t),i.setAttribute("href","#"),i.setAttribute("data-template-type","custom_"+n),i.className="ptb_ptt_remove",i.innerHTML='<svg aria-hidden="true" class="ptb_fa ptb_ti-close"><use href="#ptb-ti-close"></use></svg> '+ptb_js_admin.remove_template,t.appendChild(i),m(t),a.previousElementSibling.append(t)}})}(),m(),function(){if(document.location.hash){const e=document.location.hash.substring(1);let t;(t="single"===e||"archive"===e?document.getElementById("ptb_ptt_edit_"+e):document.querySelector('a.ptb_ptt_edit_button[data-template-type="custom_'+decodeURI(e)+'"]'))&&t.click()}}())}}}()),t(function(){var i;return{init:function(){!function(){return 0!==(i=$(".ptb_post_cmb_wrapper, form#edittag")).length}()||!function(){var t,e;i.find(".ptb_post_cmb_item_wrapper").each(function(){t=$(this),e=t.attr("id"),$.event.trigger({type:"ptb_post_cmb_"+t.data("ptb-cmb-type")+"_handle",id:e,cmbItem:t}),$.event.trigger({type:"ptb_post_cmb_"+t.data("ptb-cmb-type")+"_body_handle",id:e,cmbItemBody:t.find(".ptb_post_cmb_body_wrapper")})})}();const t=i.find("> .ptb_cmb_edit_link");t&&t.appendTo(i.closest(".postbox").find(".postbox-header h2"))}}}()),$(document).on("ptb_metabox_create_text",function(e){var t=e.container.find("input[id^="+e.id+"_default_value_]"),i=e.options.repeatable?"yes":"no";t.each(function(){var t=$(this).attr("id").replace(e.id+"_default_value_","");$(this).val(e.options.defaultValue[t])}),$("#"+e.id+"_repeatable_"+i).prop("checked",!0)}).on("ptb_add_metabox_text",function(t){return{defaultValue:"",repeatable:!1}}).on("ptb_metabox_save_text",function(e){e.options.defaultValue={},$("input[id^="+e.id+"_default_value_]").each(function(){var t=$(this).attr("id").replace(e.id+"_default_value_","");e.options.defaultValue[t]=$(this).val()}),e.options.repeatable=0<$("#"+e.id+"_repeatable_yes:checked").length}).on("ptb_post_cmb_text_body_handle",function(i){var n=i.cmbItemBody.find(".ptb_cmb_options_wrapper");if(0===n.length)return!1;var a=n.children().first().clone();function o(t){t.preventDefault(),t.data.item.hide("blind",500,function(){$(this).remove()})}n.sortable({placeholder:"ui-state-highlight"}),i.cmbItemBody.find(".ptb_cmb_option_add").on("click",{wrapper:n},function(t){var e=a.clone();e.appendTo(n).hide().show("blind",500),e.find('input[name="'+i.id+'[]"]').val(""),e.find("."+i.id+"_remove").on("click",{item:e},o),t.data.wrapper.sortable("refresh")}),n.children().each(function(){var t=$(this);t.find("."+i.id+"_remove").on("click",{item:t},o)})}).on("ptb_metabox_create_email",function(t){t.container.find("input[id^="+t.id+"_default_value]").val(t.options.defaultValue)}).on("ptb_add_metabox_email",function(t){return{defaultValue:""}}).on("ptb_metabox_save_email",function(t){t.options.defaultValue=$("input[id^="+t.id+"_default_value]").val().trim()}).on("ptb_metabox_create_number",function(t){t.options.range&&$("#"+t.id+"_range").prop("checked",!0)}).on("ptb_add_metabox_number",function(t){return{range:!1}}).on("ptb_metabox_save_number",function(t){t.options.range=$("input[id^="+t.id+"_range]:checked").val()}).on("ptb_metabox_create_textarea",function(e){e.container.find("input[id^="+e.id+"_default_value_]").each(function(){var t=$(this).attr("id").replace(e.id+"_default_value_","");$(this).val(e.options.defaultValue[t])}),e.options.editor&&$("#"+e.id+"_editor").prop("checked",!0)}).on("ptb_add_metabox_textarea",function(t){return{defaultValue:"",editor:!1}}).on("ptb_metabox_save_textarea",function(e){e.options.defaultValue={},$("input[id^="+e.id+"_default_value_]").each(function(){var t=$(this).attr("id").replace(e.id+"_default_value_","");e.options.defaultValue[t]=$(this).val()}),e.options.editor=$("#"+e.id+"_editor").is(":checked")}).on("ptb_metabox_create_radio_button",function(n){var a=n.container.find("."+n.id+"_option_wrapper"),o=n.container.find("#"+n.id+"_options_wrapper");function r(t){t.preventDefault(),t.data.option.hide("blind",500,function(){$(this).remove()})}a.remove(),n.options.columns&&n.container.find("#"+n.id+"_columns").val(n.options.columns),$.each(n.options.options,function(t,i){var e;void 0!==i.id&&((e=a.clone()).appendTo(o),e.find('input[name^="'+n.id+'_options_"]').each(function(){var t=(t=$(this).attr("name").replace(n.id+"_options_","")).replace("[]",""),t=i[t]||i.name,e=$.isNumeric(i.id)?i.id:i.id.replace(n.id+"_","");$(this).val(t).attr("id",n.id+"_"+e).data("id",e)}),e.find("."+n.id+"_remove").click({option:e},r),e.find('input[name="'+n.id+'_default_selected"]').attr("checked",i.selected))}),o.sortable({placeholder:"ui-state-highlight",handle:".ptb_cmb_option_sort"}),n.container.find("#"+n.id+"_add_new").click({id:n.id,option:a,wrapper:o},function(t){t.preventDefault();var e=t.data.option.clone(),i=e.find('input[name="'+t.data.id+'_default_selected"]'),n=function(t){t=$("#"+t.data.id+'_options_wrapper input[name^="'+t.data.id+'_options_"]').map(function(){return $(this).data("id")}),t=0===(t=t.filter(function(t){return 0<t})).length?0:Math.max.apply(null,t);t=t||0;return++t}(t);e.find('input[name^="'+t.data.id+'_options_"]').val("").attr("id",t.data.id+"_"+n).data("id",n),i.attr("checked",!1),e.find("."+t.data.id+"_remove").click({option:e},r),e.appendTo(t.data.wrapper).hide().show("blind",500),t.data.wrapper.sortable("refresh")})}).on("ptb_add_metabox_radio_button",function(t){return{options:[{name:"Option 1",id:1,selected:!0},{name:"Option 2",id:2,selected:!1}]}}).on("ptb_metabox_save_radio_button",function(n){n.options.options={},$("#"+n.id+"_options_wrapper").children("li").each(function(e){var t=$(this).find("input[name^="+n.id+"_options_]"),i=$(this).find("input[name^="+n.id+"_default_selected]").is(":checked");n.options.options[e]={},t.each(function(){var t=(t=$(this).attr("name").replace(n.id+"_options_","")).replace("[]","");n.options.options[e][t]=$(this).val(),n.options.options[e].selected=i,n.options.options[e].id=$(this).attr("id")})}),n.options.columns=$("#"+n.id+"_columns").val()}).on("ptb_metabox_create_checkbox",function(n){var a=n.container.find("."+n.id+"_option_wrapper"),o=n.container.find("#"+n.id+"_options_wrapper");function r(t){t.preventDefault(),t.data.option.hide("blind",500,function(){$(this).remove()})}a.remove(),$.each(n.options.options,function(t,i){var e;void 0!==i.id&&((e=a.clone()).appendTo(o),e.find('input[name^="'+n.id+'_options_"]').each(function(){var t=(t=$(this).attr("name").replace(n.id+"_options_","")).replace("[]",""),t=i[t]||i.name,e=$.isNumeric(i.id)?i.id:i.id.replace(n.id+"_","");$(this).val(t).attr("id",n.id+"_"+e).data("id",e)}),e.find("."+n.id+"_remove").click({option:e},r),e.find('input[name="'+n.id+'_default_checked"]').attr("checked",i.checked))}),o.sortable({placeholder:"ui-state-highlight",handle:".ptb_cmb_option_sort"}),n.options.columns&&n.container.find("#"+n.id+"_columns").val(n.options.columns),n.container.find("#"+n.id+"_add_new").click({id:n.id,option:a,wrapper:o},function(t){t.preventDefault();var e=t.data.option.clone(),i=function(t){t=$("#"+t.data.id+'_options_wrapper input[name^="'+t.data.id+'_options_"]').map(function(){return $(this).data("id")}),t=Math.max.apply(null,t);return++t}(t);e.find('input[name^="'+t.data.id+'_options_"]').val("").attr("id",t.data.id+"_"+i).data("id",i),e.find('input[name="'+t.data.id+'_default_checked"]').attr("checked",!1),e.find("."+t.data.id+"_remove").click({option:e},r),e.appendTo(t.data.wrapper).hide().show("blind",500),t.data.wrapper.sortable("refresh")})}).on("ptb_add_metabox_checkbox",function(t){return{options:[{name:"Option 1",id:1,checked:!1},{name:"Option 2",id:2,checked:!1}]}}).on("ptb_metabox_save_checkbox",function(n){n.options.options={},$("#"+n.id+"_options_wrapper").children("li").each(function(e){var t=$(this).find("input[name^="+n.id+"_options_]"),i=$(this).find("input[name^="+n.id+"_default_checked]").is(":checked");n.options.options[e]={},t.each(function(){var t=(t=$(this).attr("name").replace(n.id+"_options_","")).replace("[]","");n.options.options[e][t]=$(this).val(),n.options.options[e].checked=i,n.options.options[e].id=$(this).attr("id")})}),n.options.columns=$("#"+n.id+"_columns").val()}).on("ptb_metabox_create_select",function(n){n.container.find('input[name="'+n.id+'_multiple_selects"]').filter('[value="'+(n.options.multipleSelects?"Yes":"No")+'"]').attr("checked",!0);var a=n.container.find("."+n.id+"_option_wrapper"),o=n.container.find("#"+n.id+"_options_wrapper");function r(t){t.preventDefault(),t.data.option.hide("blind",500,function(){$(this).remove()})}a.remove(),$.each(n.options.options,function(t,i){var e;void 0!==i.id&&((e=a.clone()).appendTo(o),e.find('input[name^="'+n.id+'_options_"]').each(function(){var t=(t=$(this).attr("name").replace(n.id+"_options_","")).replace("[]",""),t=i[t]||i.name,e=$.isNumeric(i.id)?i.id:i.id.replace(n.id+"_","");$(this).val(t).attr("id",n.id+"_"+e).data("id",e)}),e.find("."+n.id+"_remove").click({option:e},r))}),o.sortable({placeholder:"ui-state-highlight"}),n.container.find("#"+n.id+"_add_new").click({id:n.id,option:a,wrapper:o},function(t){t.preventDefault();var e=t.data.option.clone(),i=function(t){t=$("#"+t.data.id+'_options_wrapper input[name^="'+t.data.id+'_options_"]').map(function(){return $(this).data("id")}),t=Math.max.apply(null,t);return++t}(t);e.find('input[name^="'+t.data.id+'_options_"]').val("").attr("id",t.data.id+"_"+i).data("id",i),e.find("."+t.data.id+"_remove").click({option:e},r),e.appendTo(t.data.wrapper).hide().show("blind",500),t.data.wrapper.sortable("refresh")})}).on("ptb_add_metabox_select",function(t){return{multipleSelects:!1,options:[{name:"Option 1",id:1},{name:"Option 2",id:2}]}}).on("ptb_metabox_save_select",function(i){i.options.multipleSelects="Yes"===$('input[name="'+i.id+'_multiple_selects"]:checked').val(),i.options.options={},$("#"+i.id+"_options_wrapper").children("li").each(function(e){var t=$(this).find("input[name^="+i.id+"_options_]");i.options.options[e]={},t.each(function(){var t=(t=$(this).attr("name").replace(i.id+"_options_","")).replace("[]","");i.options.options[e][t]=$(this).val(),i.options.options[e].id=$(this).attr("id")})})}).on("ptb_post_cmb_image_body_handle",function(e){var i;$('input[name="'+e.id+'[]"].ptb_cmb_image_url').on("paste keyup keypress change",function(){var t=$(this);$('input[name="'+e.id+'[]"][type="hidden"]').val(""),setTimeout(function(){$("#image_"+e.id).css("background-image","url("+t.val()+")")},100)}),$("#image_"+e.id).on("click",function(t){t.preventDefault(),i||(i=wp.media.frames.file_frame=wp.media({title:$(this).data("uploader_title"),button:{text:$(this).data("uploader_button_text")},library:{type:"image"},multiple:!1})).on("select",function(){var t=i.state().get("selection").first().toJSON();$('input[name="'+e.id+'[]"][type="hidden"]').val(t.id),$('input[name="'+e.id+'[]"].ptb_cmb_image_url').val(t.url),$("#image_"+e.id).css("background-image","url("+t.url+")")}),i.open()})});var e,i=["text","textarea","radio_button","checkbox","select","image","link_button"];for(e in i)$(document).on("ptb_template_item_create_"+i[e],function(t){t.title.html(t.options.name)});$(document).on("ptb_template_item_create_title",function(t){t.title.html("Title")}).on("ptb_template_item_create_content",function(t){t.title.html("Content")}),t(function(){var t,e,i,n,a,o,r,p,s=function(){p=o.filter(":checked").val();var t=$('a[href="#ptb_export_cpt_list"]').siblings();"linked"===p?t.fadeOut().click():t.fadeIn()};return{init(){!function(){return 0!==$("form#ptb_form_export").length&&(o=$('input[name="ptb_export_mode"]'),s(),t=$("#ptb_export"),e=$("#ptb_import"),i=$("#ptb_export_cpt_list"),n=$("#ptb_export_ctx_list"),a=$("#ptb_export_ptt_list"),!0)}()||(function(){o.on("change",s)}(),function(){$(".nav-tab-wrapper a").on("click",function(t){t.preventDefault(),$(this).hasClass("nav-tab-active")||($(this).addClass("nav-tab-active").siblings().removeClass("nav-tab-active"),t=$(this).attr("href"),$(".ptb_tab_content").not(t).css("display","none"),$(t).fadeIn())})}(),function(){t.on("click",function(t){var e;switch(t.preventDefault(),r=$("a.nav-tab-active").data("target")){case"cpt":e=i;break;case"ctx":e=n;break;case"ptt":e=a;break;default:e=i}t={mode:p,target:r,list:e.find("input:checked").map(function(){return $(this).val()}).get()};$('input[name="ptb_plugin_options[ptb_ie_export]"]').val(JSON.stringify(t)),$("form#ptb_form_export").submit()})}(),function(){e.addClass("disabled"),$("input:file").on("change",function(){$(this).val()?e.removeClass("disabled"):e.addClass("disabled")}),e.on("click",function(t){t.preventDefault(),$("input:file").val()&&$("form#ptb_form_import").submit()})}())}}}()),window.addEventListener("load",function(){$(".ptb_interface select").wrap("<div class='ptb_custom_select'></div>"),$(".ptb_number").on("keyup",function(){/^[1-9][0-9]*[.,]*[0-9]*$/gi.test($(this).val())||$(this).val($(this).val().replace(/[^0-9.,]/,""))}),$(document).on("click",".ptb_remove_dialog_form input",function(t){t.preventDefault(),t.stopPropagation();var t=$(this).closest("form"),e=$(this).data("confirm");if(e&&!confirm(e))return!1;$('input[name="remove"]',t).val(e?"1":"0");var n=$(".ptb_alert",t);$.ajax({type:"POST",url:ajaxurl,dataType:"json",data:t.serialize(),beforeSend(){n.removeClass("done error").addClass("busy").show()},complete(){n.removeClass("busy")},success:function(t){var e,i;t&&(e="",i=t.success?(e="done",function(){"1"==t.data?window.location.reload():window.location=t.data}):(e="error",function(){t.data&&alert(t.data)}),n.addClass(e),setTimeout(function(){n.animate({opacity:0},300,i)},800))}})}).on("click",".ptb_register,.ptb_unregister,.ptb_cpt_copy,.ptb_ctx_copy",function(t){t.preventDefault(),t.stopPropagation(),$.ajax({type:"POST",url:this,dataType:"json",success:function(t){t&&("1"==t.data?window.location.reload():window.location=t.data)}})})},{once:!0,passive:!0}),PTB_Layout={init(){var a=$("#ptb_pre_wrapper"),o=this;0<a.length&&$.getJSON("https://themify.org/public-api/ptb-layouts/index.json").done(t=>{if(t){var e,i="";for(e in t)i=(i=(i=(i=(i=(i+="<li>")+'<div class="ptb_pre_overlay" style="background-image:url('+t[e].img+')"></div>')+'<div class="ptb_pre_content"><a class="ptb_pre_zoom" href="'+t[e].url+'"><svg aria-hidden="true" class="ptb_fa ptb_ti-zoom-in"><use href="#ptb-ti-zoom-in"></use></svg></a>')+'<div class="ptb_pre_import"><a target="_blank" href="'+t[e].url+'">'+t[e].title+"</a>")+'<div class="ptb_pre_actions"><label><input type="checkbox" value="'+e+'" name="sample" />'+ptb_js_admin.import_samples+"</label>")+'<input class="ptb_pre_import_btn" type="button" data-slug="'+e+'" value="'+ptb_js_admin.import+'" /></div></div></div></li>';var n=a.find("ul");n.empty(),n[0].insertAdjacentHTML("afterbegin",i),o.preview(),o.import()}})},preview(){$(".ptb_pre_zoom").on("click",function(t){t.preventDefault(),openLightBox(t,"",'<iframe id="ptb_preview_iframe" src="'+$(this).prop("href")+'"></iframe>',"ptb_preview_iframe_wrapper")})},progress(t,e,i,n){"loading"===t&&document.body.insertAdjacentHTML("beforeend",'<div id="ptb_pre_progress_wrap" class="ptb_admin_lightbox ptb_scrollbar"><div class="ptb_pre_progress"><div class="ptb_pre_progress_indicator">0%</div></div><div class="ptb_pre_progress_info"></div><div class="ptb_pre_progress_count"></div></div><div class="ptb_overlay"></div>'),i&&n&&$(".ptb_pre_progress_count").html(i+" / "+n),void 0!==ptb_js_admin.import_pre[t]&&(i=ptb_js_admin.import_pre[t],e&&(i=i.replace("%s",e)),$(".ptb_pre_progress_info").html(i))},setIndicator(t){t+="%",$(".ptb_pre_progress").css("width",t).find(".ptb_pre_progress_indicator").html(t)},import:function(){var g=this;$(".ptb_pre_import_btn").on("click",function(t){t.preventDefault();var i,n=$(this).data("slug"),t=$(this).closest("#ptb_pre_wrapper").data("cpt");-1!==$.inArray(n,t)&&!confirm(ptb_js_admin.confirm_import.replace("%s",n))||(g.progress("loading"),i=$(this).closest(".ptb_pre_actions").find('input[type="checkbox"]').is(":checked"),g.setIndicator(10),$.getJSON("https://themify.org/public-api/ptb-layouts/"+n+".json").done(function(e){var _,u,m,b,f,h,v;e&&(_=t=>(g.setIndicator(80),g.progress("saving"),$.ajax({url:ajaxurl,type:"POST",dataType:"json",data:{slug:n,cpt:JSON.stringify(e),action:"ptb_import_pre_cpt",samples:t?JSON.stringify(t):""},success:function(t){t&&t.status?(g.setIndicator(100),g.progress("finish")):alert("Something went wrong"),setTimeout(function(){$("#ptb_pre_progress_wrap,.ptb_overlay").remove(),t.status&&setTimeout(function(){window.location.reload()},100)},2e3)}})),g.progress("cpt",n),g.setIndicator(i?20:45),i?(g.progress("start_samples"),m=1,f=[],h=0,(v=()=>{$.ajax({url:"https://themify.org/ptb/wp-json/wp/v2/"+n+"?statuses=public&per_page=5&page="+m,dataType:"json",crossDomain:!0,success(t,e,i){if("success"===e&&t){u||(u=i.getResponseHeader("X-WP-TotalPages"),b=i.getResponseHeader("X-WP-Total")),g.setIndicator(20+5*m),g.progress(null,null,5*m,b);for(var a,o,r=0,p=t.length;r<p;++r){var n={};if(t[r].ptb_taxonomy){var s,l=t[r].ptb_taxonomy;for(s in l){n[s]={};for(var c=0,d=l[s].length;c<d;++c)n[s][l[s][c].slug]=l[s][c].name}}t[r].ptb_featured_image&&++h,g.progress("samples",t[r].title.rendered),f.push({post_type:t[r].type,title:t[r].title.rendered,excerpt:t[r].excerpt.rendered,content:t[r].content.rendered,meta:t[r].ptb_metabox||null,tax:n,img:t[r].ptb_featured_image||null})}++m!=u?setTimeout(v,800):(a=50,g.progress("start_images",null,b,b),g.setIndicator(a),m=b=u=null,r=0,p=f.length,(o=function(){var n;f[r].img?(g.progress(null,null,r,h-1),n=new XMLHttpRequest,g.progress("images",f[r].img.url),g.setIndicator(a+r),n.open("GET",f[r].img.url,!0),n.responseType="blob",n.onload=function(t){var e,i;200===this.status&&(e=new FormData,i=new XMLHttpRequest,e.append("file",this.response),f[r].img.title&&e.append("title",f[r].img.title),f[r].img.caption&&e.append("caption",f[r].img.caption),i.responseType="json",i.open("POST",ajaxurl+"?action=ptb_upload_blob",!0),i.onload=function(t){this.response.id&&(f[r].img=this.response.id),++r<p?setTimeout(o,300):_(f)},i.send(e),e=n=null)},n.onerror=function(t){alert("Cant`t Load the image "+f[r].url)},n.send()):++r<p&&setTimeout(o,300)})())}},error(){alert("Can't get samples")}})})()):_(null))}))})}},PTB_Tabs={init(){const e=document.getElementsByClassName("ptb-tabs");if(e)for(let t=0;t<e.length;t++){const i=e[t].querySelector(".nav-tab-wrapper");i.addEventListener("click",function(t){if(t.preventDefault(),t.target&&"A"===t.target.tagName){const e=t.target.getAttribute("href").substring(1),i=this.closest(".nav-tab-wrapper").querySelectorAll("a"),n=this.closest(".ptb-tabs").querySelectorAll(":scope > div");for(let t=0;t<n.length;t++)n[t].style.display=n[t].id===e?"block":"none";for(let t=0;t<i.length;t++)i[t].classList.remove("nav-tab-active");t.target.classList.add("nav-tab-active")}})}}}})(jQuery),window.addEventListener("load",()=>{"use strict";PTB_Tabs.init(),InitLanguageTabs(),ThemplateDelete();const $=jQuery,t=(PTB_Layout.init(),$("body").on("click","a.ptb_custom_lightbox",function(e){e.preventDefault(),e.stopPropagation(),PTB_Common.show_loader(),$(".ptb_current_ajax").removeClass("ptb_current_ajax"),$(this).addClass("ptb_current_ajax");var i=$(this);let t=this.dataset.href||this.href;$.ajax({url:t,success:function(t){t&&openLightBox(e,i.attr("title"),t,i.data("class"),i.data("top"))}})}).on("ptb_pre_layout_update",()=>{PTB_Layout.init()}),document.getElementById("ptb_admin_custom_labels_heading"));t&&(t.parentElement.colSpan=2)},{once:!0,passive:!0});var PTB_Layout,PTB_Tabs,InitLanguageTabs=function(){"use strict";var $=jQuery;$("body").on("click",".ptb_language_tabs li",function(t){var e;t.preventDefault(),$(this).hasClass("ptb_active_tab_lng")||(e=(t=$(this).closest("ul")).next("ul"),t.find(".ptb_active_tab_lng").removeClass("ptb_active_tab_lng"),$(this).addClass("ptb_active_tab_lng"),e.find(".ptb_active_lng").removeClass("ptb_active_lng"),e.find("li").eq($(this).index()).addClass("ptb_active_lng"))})},ThemplateDelete=function(){"use strict";jQuery(".templates .delete a").on("click",function(t){confirm(ptb_js_admin.template_delete)||t.preventDefault()})},lightboxCloseKeyListener=function(t){"use strict";27===t.keyCode&&(t.preventDefault(),closeLightBox(t))},openLightBox=function(t,e,i,n,a){"use strict";t.preventDefault();var $=jQuery,o="ptb_"+Math.random().toString(36).substr(2,9),e='<div id="'+o+'" class="ptb_admin_lightbox ptb_scrollbar ptb_icon_lightbox ptb_interface"><div class="ptb_lightbox_title">'+(e||"")+'</div><a href="#" class="ptb_close_lightbox">×</a><div id="ptb_lightbox_container"><div class="ptb_lightbox_inner">'+i+'</div></div></div><div class="ptb_overlay"></div>',r=($(document).on("keyup",lightboxCloseKeyListener),$("body").append(e),$("#"+o));n&&r.addClass(n),PTB_Common.hide_loader(),r.show(),setTimeout(function(){r.addClass("ptb_lightbox_show").one("transitionend webkitTransitionEnd oTransitionEnd",function(){a&&a(),$.event.trigger("PTB.openlightbox",[t,o])}).find(".ptb_close_lightbox").on("click",closeLightBox)},100),document.body.classList.add("ptb_lightbox_active")},closeLightBox=function(t){"use strict";t.preventDefault();var $=jQuery,t=$(this).closest(".ptb_admin_lightbox");$(document).off("keyup",lightboxCloseKeyListener),$.event.trigger("PTB.close_lightbox",this),t.removeClass("ptb_lightbox_show").one("transitionend webkitTransitionEnd oTransitionEnd",function(){$(this).next(".ptb_overlay").remove(),$(this).remove()}),document.body.classList.remove("ptb_lightbox_active")};